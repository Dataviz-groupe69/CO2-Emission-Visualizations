<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Datavis project</title>
    <style>
        #slider{
            background-color: rgb(0, 255, 255);
            color:#00FFFF;
            width: 40%;
            margin-left: 30%;
        }


    </style>
</head>
<body>
<div>
    <input id="slider" type="range" value="1" min="1" max="135" step="1" width="200" />
    <span id="year">1880</span>
</div>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://unpkg.com/d3-simple-slider/build/d3-simple-slider.js"></script>
<script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
<script data-require="d3@3.5.3" data-semver="3.5.3" src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script><script>
    var margin = {
            top: 20,
            right: 100,
            bottom: 30,
            left: 100
        },
        width = window.innerWidth- margin.left - margin.right,
        height = window.innerHeight*0.75- margin.top - margin.bottom;
    var svg = d3.select("body").append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");



d3.csv("./sea-level.csv",function (error,data) {
    if (error) throw error;
    var year = 1880;
    var choice = 1;
    d3.select("#slider").on("input", function() {
        //var root_2 = root;
        year = Number(1879) + Number(this.value)
        choice = this.value - 1;
        d3.select('#year').text(year);
        svg.select("#sealevel").remove();

        svg.selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("x","0px")
            .attr("y",height).attr("height",function (d,i) {
            if(i === choice){
                return y(d.CSIRO);
            }
        }).attr("width",0.5*width).attr("fill","blue")
    });
    var rectangles = [{"name": "venis", "x": 10, "y": 0.5 * height + 30}, {
        "name": "venis",
        "x": 60,
        "y": 0.5 * height + 35
    }, {"name": "venis", "x": 25, "y": 0.5 * height + 25}, {"name": "venis", "x": 80, "y": 0.5 * height + 40}]

    svg.selectAll("rect")
        .data(rectangles)
        .enter()
        .append("rect")
        .attr("width", "20px")
        .attr("height", "14px")
        .attr("x", function (d) {
        return d.x

    }).attr("y", function (d) {
        return d.y;

    })
    var x = d3.scaleLinear()
        .range([0, 0.5 * width]);

    var y = d3.scaleLinear()
        .range([height, 0.5 * height]);

    var color = d3.scale.category10();

    y.domain([0,d3.max(data,function (d) {
        return d.CSIRO;
    })])


    var xAxis = d3.axisBottom(x);

    var yAxis = d3.axisLeft(y);



    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis)


})

    </script>

</body>
</html>